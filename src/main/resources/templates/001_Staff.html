<!DOCTYPE HTML>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <title>SMW - TECHCAM</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- App favicon -->
    <link rel="shortcut icon" href="https://cdn-icons-png.flaticon.com/512/809/809052.png">

    <!-- DataTables -->
    <link rel="stylesheet" type="text/css" th:href="@{/assets/css/dataTables.bootstrap4.min.css}">
    <link rel="stylesheet" type="text/css" th:href="@{/assets/css/buttons.bootstrap4.min.css}">

    <!-- Responsive datatable examples -->
    <link rel="stylesheet" type="text/css" th:href="@{/assets/css/responsive.bootstrap4.min.css}">

    <!-- Bootstrap Css -->
    <link id="bootstrap-style" rel="stylesheet" type="text/css" th:href="@{/assets/css/bootstrap.min.css}">

    <!-- Bootstrap datepicker -->
    <link rel="stylesheet" th:href="@{/assets/css/bootstrap-datepicker.min.css}">
    <link rel="stylesheet" th:href="@{/assets/css/bootstrap-datepicker.standalone.min.css}">
    <link rel="stylesheet" th:href="@{/assets/css/bootstrap-datepicker3.min.css}">
    <link rel="stylesheet" th:href="@{/assets/css/bootstrap-datepicker3.standalone.min.css}">

    <!-- Icons Css -->
    <link rel="stylesheet" type="text/css" th:href="@{/assets/css/icons.min.css}">
    <!-- App Css-->
    <link id="app-style" rel="stylesheet" type="text/css" th:href="@{/assets/css/app.min.css}">
    <!-- Chosen -->
    <link rel="stylesheet" type="text/css" th:href="@{/assets/css/chosen.min.css}">

    <!-- SweetAlert2-->
    <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <!-- Custom CSS -->
    <link rel="stylesheet" type="text/css" th:href="@{/assets/css/style.css}"/>
</head>
<body data-topbar="colored" data-layout="horizontal">

<!-- Loader -->
<div id="preloader">
    <div id="status">
        <div class="spinner"></div>
    </div>
</div>

<!-- Begin page -->
<div id="layout-wrapper">

    <header id="page-topbar">
        <div class="navbar-header mx-auto">
            <div class="d-flex">
                <!-- LOGO -->
                <div class="navbar-brand-box d-block d-lg-none">
                    <a href="index.html" class="logo logo-light">
                            <span class="logo-sm">
                                <img src="https://cdn-icons-png.flaticon.com/512/809/809052.png" alt="" height="22">
                            </span>
                    </a>
                </div>

                <button type="button"
                        class="btn btn-sm me-2 font-size-24 d-lg-none header-item waves-effect waves-light"
                        data-bs-toggle="collapse" data-bs-target="#topnav-menu-content">
                    <i class="mdi mdi-menu"></i>
                </button>

                <ul class="list-inline d-none d-lg-block mb-0">
                    <li class="list-inline-item me-3 help-number">
                        <span class="font-size-13 header-item">Hỗ trợ : +012 3456 789</span>
                    </li>
                    <li class="list-inline-item">
                        <div class="dropdown d-none d-lg-block">
                            <button type="button" class="btn header-item waves-effect" data-bs-toggle="dropdown"
                                    aria-haspopup="true" aria-expanded="false">
                                <img class="me-2" src="assets/img/vn_flag.jpg" alt="Header Language" height="14"><span
                                    class="mdi mdi-chevron-down">Vietnam</span>
                            </button>
                            <div class="dropdown-menu dropdown-menu-end">

                                <!-- item-->
                                <a href="javascript:void(0);" class="dropdown-item notify-item">
                                    <img src="assets/img/us_flag.jpg" alt="user-image" class="me-1" height="12"> <span
                                        class="align-middle"> United States </span>
                                </a>

                                <!-- item-->
                                <a href="javascript:void(0);" class="dropdown-item notify-item">
                                    <img src="assets/img/french_flag.jpg" alt="user-image" class="me-1" height="12">
                                    <span class="align-middle"> French </span>
                                </a>

                                <!-- item-->
                                <a href="javascript:void(0);" class="dropdown-item notify-item">
                                    <img src="assets/img/germany_flag.jpg" alt="user-image" class="me-1" height="12">
                                    <span class="align-middle"> German </span>
                                </a>

                                <!-- item-->
                                <a href="javascript:void(0);" class="dropdown-item notify-item">
                                    <img src="assets/img/italy_flag.jpg" alt="user-image" class="me-1" height="12">
                                    <span class="align-middle"> Italian </span>
                                </a>

                                <!-- item-->
                                <a href="javascript:void(0);" class="dropdown-item notify-item">
                                    <img src="assets/img/spain_flag.jpg" alt="user-image" class="me-1" height="12">
                                    <span class="align-middle"> Spanish </span>
                                </a>
                            </div>
                        </div>
                    </li>

                </ul>

            </div>

            <!-- Search input -->
            <div class="search-wrap" id="search-wrap">
                <div class="search-bar">
                    <input class="search-input form-control" placeholder="Search">
                    <a href="#" class="close-search toggle-search" data-target="#search-wrap">
                        <i class="mdi mdi-close-circle"></i>
                    </a>
                </div>
            </div>

            <div class="d-flex">

                <div class="dropdown d-none d-lg-block">
                    <button type="button" class="btn header-item toggle-search noti-icon waves-effect"
                            data-target="#search-wrap">
                        <i class="mdi mdi-magnify"></i>
                    </button>
                </div>


                <div class="dropdown d-inline-block ms-2">
                    <button type="button" class="btn header-item noti-icon waves-effect"
                            id="page-header-notifications-dropdown" data-bs-toggle="dropdown" aria-haspopup="true"
                            aria-expanded="false">
                        <i class="mdi mdi-bell-outline"></i>
                        <span class="badge bg-danger rounded-pill">3</span>
                    </button>
                    <div class="dropdown-menu dropdown-menu-lg dropdown-menu-end p-0"
                         aria-labelledby="page-header-notifications-dropdown">
                        <div class="p-3">
                            <div class="row align-items-center">
                                <div class="col">
                                    <h5 class="m-0 font-size-16"> Notification (3) </h5>
                                </div>
                            </div>
                        </div>
                        <div data-simplebar style="max-height: 230px;">
                            <a href="" class="text-reset notification-item">
                                <div class="d-flex">
                                    <div class="avatar-xs me-3">
                                            <span class="avatar-title bg-success rounded-circle font-size-16">
                                                <i class="mdi mdi-cart-outline"></i>
                                            </span>
                                    </div>
                                    <div class="flex-1">
                                        <h6 class="mt-0 font-size-15 mb-1">Your order is placed</h6>
                                        <div class="font-size-12 text-muted">
                                            <p class="mb-1">Dummy text of the printing and typesetting industry.</p>
                                        </div>
                                    </div>
                                </div>
                            </a>

                            <a href="" class="text-reset notification-item">
                                <div class="d-flex">
                                    <div class="avatar-xs me-3">
                                            <span class="avatar-title bg-danger rounded-circle font-size-16">
                                                <i class="mdi mdi-message-text-outline"></i>
                                            </span>
                                    </div>
                                    <div class="flex-1">
                                        <h6 class="mt-0 font-size-15 mb-1">New Message received</h6>
                                        <div class="font-size-12 text-muted">
                                            <p class="mb-1">You have 87 unread messages</p>
                                        </div>
                                    </div>
                                </div>
                            </a>

                            <a href="" class="text-reset notification-item">
                                <div class="d-flex">
                                    <div class="avatar-xs me-3">
                                            <span class="avatar-title bg-info rounded-circle font-size-16">
                                                <i class="mdi mdi-glass-cocktail"></i>
                                            </span>
                                    </div>
                                    <div class="flex-1">
                                        <h6 class="mt-0 font-size-15 mb-1">Your item is shipped</h6>
                                        <div class="font-size-12 text-muted">
                                            <p class="mb-1">It is a long established fact that a reader will</p>
                                        </div>
                                    </div>
                                </div>
                            </a>
                            <a href="" class="text-reset notification-item">
                                <div class="d-flex">
                                    <div class="avatar-xs me-3">
                                            <span class="avatar-title bg-success rounded-circle font-size-16">
                                                <i class="mdi mdi-message-text-outline"></i>
                                            </span>
                                    </div>
                                    <div class="flex-1">
                                        <h6 class="mt-0 font-size-15 mb-1">New Message received</h6>
                                        <div class="font-size-12 text-muted">
                                            <p class="mb-1">You have 87 unread messages</p>
                                        </div>
                                    </div>
                                </div>
                            </a>

                            <a href="" class="text-reset notification-item">
                                <div class="d-flex">
                                    <div class="avatar-xs me-3">
                                            <span class="avatar-title bg-warning rounded-circle font-size-16">
                                                <i class="mdi mdi-cart-outline"></i>
                                            </span>
                                    </div>
                                    <div class="flex-1">
                                        <h6 class="mt-0 font-size-15 mb-1">Your order is placed</h6>
                                        <div class="font-size-12 text-muted">
                                            <p class="mb-1">Dummy text of the printing and typesetting industry.</p>
                                        </div>
                                    </div>
                                </div>
                            </a>
                        </div>

                        <div class="p-2 border-top">
                            <a class="btn btn-sm btn-link font-size-14 btn-block" href="javascript:void(0)">
                                View all
                            </a>
                        </div>
                    </div>
                </div>

                <div class="dropdown d-inline-block ms-2">
                    <button type="button" class="btn header-item waves-effect" id="page-header-user-dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <img class="rounded-circle header-profile-user" src="assets/img/avatar-6.jpg" alt="Header Avatar">
                        <span class="d-none d-md-inline-block ms-1">
                            VDB
                            <i class="mdi mdi-chevron-down"></i>
                        </span>
                    </button>
                    <div class="dropdown-menu dropdown-menu-end">
                        <!-- item-->
                        <a class="dropdown-item" href="#">
                            <i class="dripicons-user font-size-16 align-middle me-2 text-muted"></i>
                            Profile
                        </a>
                        <a class="dropdown-item" href="#">
                            <i class="dripicons-wallet font-size-16 align-middle me-2 text-muted"></i>
                            My Wallet
                        </a>
                        <a class="dropdown-item d-block" href="#">
                            <span class="badge bg-success float-end">5</span>
                            <i class="dripicons-gear font-size-16 align-middle me-2 text-muted"></i>
                            Settings
                        </a>
                        <a class="dropdown-item" href="#">
                            <i class="dripicons-lock font-size-16 align-middle me-2 text-muted"></i>
                            Lock screen
                        </a>
                        <div class="dropdown-divider"></div>
                        <a class="dropdown-item" href="#">
                            <i class="dripicons-exit font-size-16 align-middle me-2 text-muted"></i>
                            Logout
                        </a>
                    </div>
                </div>

                <div class="dropdown d-inline-block">
                    <button type="button" class="btn header-item noti-icon right-bar-toggle waves-effect">
                        <i class="mdi mdi-spin mdi-cog"></i>
                    </button>
                </div>
            </div>
        </div>

        <div class="topnav">
            <div class="container-fluid">
                <div class="d-flex">
                    <!-- LOGO -->
                    <div class="navbar-brand-box d-none d-lg-block">
                        <a href="index.html" class="logo logo-light">
                            <span class="logo-sm">
                                <img src="https://cdn-icons-png.flaticon.com/512/809/809052.png" alt="" height="32">
                                <span style="font-size: 27px; color: yellow;">FShop</span>
                            </span>
                            <span class="logo-lg">
                                <img src="https://cdn-icons-png.flaticon.com/512/809/809052.png" alt="" height="40">
                                <span style="font-size: 27px; color: yellow;">FShop</span>
                            </span>
                        </a>
                    </div>

                    <nav class="navbar navbar-light navbar-expand-lg topnav-menu">

                        <div class="collapse navbar-collapse" id="topnav-menu-content">
                            <ul class="navbar-nav">
                                <li class="nav-item">
                                    <a class="nav-link" href="index.html"
                                       tppabs="https://themesbrand.com/foxia/layouts/blue/index.html">
                                        <i class="dripicons-meter me-2"></i>Tổng quan
                                    </a>
                                </li>

                                <li class="nav-item dropdown">
                                    <a class="nav-link dropdown-toggle arrow-none" href="#" id="topnav-user-Interface"
                                       role="button">
                                        <i class="fas fa-box-open me-2"></i>Hàng hoá
                                        <div class="arrow-down"></div>
                                    </a>

                                    <div class="dropdown-menu" aria-labelledby="topnav-user-Interface">
                                        <a href="#" class="dropdown-item">
                                            <i class="fas fa-list-ol me-2"></i>Danh mục
                                        </a>
                                        <a href="#" class="dropdown-item">
                                            <i class="fas fa-tags me-2"></i>Thiết lập giá
                                        </a>
                                        <a href="#" class="dropdown-item">
                                            <i class="fas fa-clipboard-check me-2"></i>Kiểm kho
                                        </a>
                                    </div>
                                </li>

                                <li class="nav-item dropdown">
                                    <a class="nav-link dropdown-toggle arrow-none" href="#" id="topnav-components"
                                       role="button">
                                        <i class="fas fa-exchange-alt me-2"></i>Giao dịch
                                        <div class="arrow-down"></div>
                                    </a>

                                    <div class="dropdown-menu" aria-labelledby="topnav-user-Interface">
                                        <a href="#" class="dropdown-item">
                                            <i class="fas fa-file-invoice-dollar me-2"></i>Hoá đơn
                                        </a>
                                        <a href="#" class="dropdown-item">
                                            <i class="fas fa-reply-all me-2"></i>Trả hàng
                                        </a>
                                        <a href="#" class="dropdown-item">
                                            <i class="fas fa-dolly-flatbed me-2"></i>Nhập hàng
                                        </a>
                                        <a href="#" class="dropdown-item">
                                            <i class="fas fa-upload me-2"></i>Trả hàng nhập
                                        </a>
                                        <a href="#" class="dropdown-item">
                                            <i class="fas fa-truck me-2"></i>Chuyển hàng
                                        </a>
                                    </div>
                                </li>

                                <li class="nav-item dropdown">
                                    <a class="nav-link dropdown-toggle arrow-none" href="#" id="topnav-advanced-ui" role="button">
                                        <i class="fas fa-user-tie me-2"></i>Đối tác
                                        <div class="arrow-down"></div>
                                    </a>
                                    <div class="dropdown-menu" aria-labelledby="topnav-user-Interface">
                                        <a href="#" class="dropdown-item">
                                            <i class="fas fa-user-alt me-2"></i>Khách hàng
                                        </a>
                                        <a href="#" class="dropdown-item">
                                            <i class="fas fa-users me-2"></i>Nhà cung cấp
                                        </a>
                                    </div>
                                </li>

                                <li class="nav-item">
                                    <a class="nav-link" href="#" id="topnav-pages">
                                        <i class="fas fa-dollar-sign me-2"></i>Sổ quỹ
                                    </a>
                                </li>

                                <li class="nav-item dropdown">
                                    <a class="nav-link dropdown-toggle arrow-none" href="#" id="topnav-layout" role="button">
                                        <i class="fas fa-signal me-2"></i>Báo cáo
                                        <div class="arrow-down"></div>
                                    </a>
                                    <div class="dropdown-menu" aria-labelledby="topnav-user-Interface">
                                        <a href="#" class="dropdown-item">
                                            <i class="fas fa-chart-pie me-2"></i>Cuối ngày
                                        </a>
                                        <a href="#" class="dropdown-item">
                                            <i class="fas fas fa-paste me-2"></i>Bán hàng
                                        </a>
                                        <a href="#" class="dropdown-item">
                                            <i class="fas fa-cube me-2"></i>Hàng hoá
                                        </a>
                                    </div>
                                </li>
                            </ul>
                        </div>
                    </nav>
                </div>
            </div>
        </div>

    </header>

    <!-- ============================================================== -->
    <!-- Start right Content here -->
    <!-- ============================================================== -->
    <div class="main-content">

        <div class="page-content">
            <div class="container-fluid">

                <section class="row main-page">
                    <section class="col-2 mainLeft">
                        <h1 class="heading-page">Người dùng</h1>
                        <div class="filter-report">
                            <div class="boxLeft">
                                <h3 class="leftTitle">Chức vụ</h3>
                                <div class="boxLeftC">
                                    <select class="roleFilter w-100" multiple>
                                        <option value="">Quản trị chi nhánh</option>
                                        <option value="">Nhân viên kho</option>
                                        <option value="">Nhân viên thu ngân</option>
                                    </select>
                                </div>
                            </div>
                            <div class="boxLeft">
                                <h3 class="leftTitle">Trạng thái</h3>
                                <div class="boxLeftC">
                                    <div class="form-group form-check">
                                        <input class="form-check-input" type="radio" name="status" id="statusAll" value="Tất cả" onchange="onStatusChange(this)" checked>
                                        <label class="form-check-label" for="statusAll">
                                            Tất cả
                                        </label>
                                    </div>
                                    <div class="form-group form-check">
                                        <input class="form-check-input" type="radio" name="status" id="statusActive" value="Đang hoạt động" onchange="onStatusChange(this)">
                                        <label class="form-check-label" for="statusActive">
                                            Đang hoạt động
                                        </label>
                                    </div>
                                    <div class="form-group form-check">
                                        <input class="form-check-input" type="radio" name="status" id="statusInactive" value="Ngừng hoạt động" onchange="onStatusChange(this)">
                                        <label class="form-check-label" for="statusInactive">
                                            Ngừng hoạt động
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>
                    <section class="col-10 mainRight">
                        <div class="row justify-content-end">
                            <button type="button" class="btn btn-primary col-auto mb-3 waves-effect waves-light" data-bs-toggle="modal" data-bs-target=".modal-add-staff">
                                <i class="fas fa-plus me-2"></i>Người dùng
                            </button>
                        </div>

                        <!-- Modal Add Staff -->
                        <div class="modal fade modal-add-staff" tabindex="-1" style="display: none;" aria-hidden="true">
                            <div class="modal-dialog modal-xl">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title mt-0">Thêm người dùng</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <form id="formAdd">
                                        <div class="modal-body">
                                            <div class="row">
                                                <div class="col-6 px-4">
                                                    <table class="table-borderless w-100">
                                                        <tr>
                                                            <th style="width: 140px"><label class="form-label" for="fullName">Họ và tên</label><span class="required"> *</span></th>
                                                            <td><input class="form-control" type="text" name="fullName" id="fullName" onblur="onType(this)"></td>
                                                        </tr>
                                                        <tr>
                                                            <th style="width: 140px;"><label for="email" class="form-label">Email</label><span class="required"> *</span></th>
                                                            <td><input type="email" name="email" id="email" class="form-control" onblur="onType(this)" placeholder="abc@email.com"></td>
                                                        </tr>
                                                        <tr>
                                                            <th><label for="role" class="form-label">Chức vụ</label><span class="required"> *</span></th>
                                                            <td>
                                                                <select class="form-select" name="role" id="role" onchange="onType(this)">
                                                                    <option value="" disabled selected>-- Chọn Chức vụ --</option>
                                                                    <option value="ROLE_ADMIN">Quản trị viên</option>
                                                                    <option value="ROLE_USER">Nhân viên</option>
                                                                </select>
                                                            </td>
                                                        </tr>
                                                    </table>
                                                </div>
                                                <div class="col-6 px-4">
                                                    <table class="table-borderless w-100">
                                                        <tr>
                                                            <th><label for="phoneNumber" class="form-label">Điện thoại</label><span class="required"> *</span></th>
                                                            <td><input type="number" name="phoneNumber" id="phoneNumber" class="form-control" onblur="onType(this)" placeholder="0323456789"></td>
                                                        </tr>
                                                        <tr>
                                                            <th><label for="address" class="form-label">Địa chỉ</label><span class="required"> *</span></th>
                                                            <td><input type="text" name="address" id="address" class="form-control" onblur="onType(this)"></td>
                                                        </tr>
                                                        <tr>
                                                            <th><label for="datepicker" class="form-label">Ngày sinh</label><span class="required"> *</span></th>
                                                            <td><input type="text" name="dateOfBirth" id="datepicker" class="form-control" onblur="onType(this)" placeholder="dd/MM/yyyy"></td>
                                                        </tr>
                                                        <tr>
                                                            <th style="vertical-align: top; padding-top: 7px;"><label for="note" class="form-label">Ghi chú</label></th>
                                                            <td><textarea name="note" id="note" cols="30" rows="3"></textarea></td>
                                                        </tr>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                    </form>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" onclick="resetForm()">
                                            <i class="fas fa-ban me-2"></i>Đóng
                                        </button>
                                        <button type="button" class="btn btn-success" onclick="resetForm()">
                                            <i class="fa fa-trash me-2"></i>Làm mới
                                        </button>
                                        <button type="button" id="btnAdd" class="btn btn-primary waves-effect waves-light">
                                            <i class="fas fa-save pe-2"></i>Lưu
                                        </button>
                                    </div>
                                </div>
                                <!-- /.modal-content -->
                            </div>
                            <!-- /.modal-dialog -->
                        </div>
                        <!-- End Modal Add Staff -->

                        <table id="datatable" class="table table-striped table-hover table-bordered dt-responsive nowrap dataTable no-footer">
                            <thead>
                                <th><input type="checkbox" name="checkAll" id="checkAll" onclick="checkAllJquery('checkAll', 'check-item');"></th>
                                <th>Chức năng</th>
                                <th>ID</th>
                                <th>Mã nhân viên</th>
                                <th>Họ tên</th>
                                <th>Ngày sinh</th>
                                <th>Số điện thoại</th>
                                <th>Email</th>
                                <th>Địa chỉ</th>
                                <th>Ảnh</th>
                                <th>Chức vụ</th>
                                <th>Ngày bắt đầu</th>
                                <th>Trạng thái</th>
                            </thead>
                            <tbody>
                                <tr th:each="staff : ${staffs}">
                                    <td><input type="checkbox" class="check-item" th:value="${staff.getId()}"></td>
                                    <td class="row" style="width: 100px;" th:switch="${staff.getStatus()}">
                                        <i class="col-4 fas fa-edit" style="color: darkblue;" title="Cập nhật" onclick="onBtnEdit(this)"></i>
                                        <i th:case="1" class="col-4 fas fa-lock-open" style="color: green;" title="Khoá tài khoản" onclick="onBtnStatus(this)"></i>
                                        <i th:case="0" class="col-4 fas fa-lock" style="color: red;" title="Mở khoá tài khoản" onclick="onBtnStatus(this)"></i>
                                        <i class="col-4 fas fa-user-times" style="color: red;" title="Xoá người dùng" onclick="onBtnDelete(this)"></i>
                                    </td>
                                    <td th:text="${staff.getId()}"></td>
                                    <td th:text="${staff.getStaffCode()}">Mã nhân viên</td>
                                    <td th:text="${staff.getFullName()}">Họ tên</td>
                                    <td th:text="${#dates.format(staff.getDateOfBirth(), 'dd/MM/yyyy')}">Ngày sinh</td>
                                    <td th:text="${staff.getPhoneNumber()}">Số điện thoại</td>
                                    <td th:text="${staff.getEmail()}">Email</td>
                                    <td th:text="${staff.getAddress()}">Địa chỉ</td>
                                    <td th:text="${staff.getAvatar()}">Ảnh</td>
                                    <td th:switch="${staff.getRole()}">
                                        <span th:case="ROLE_ADMIN">Quản trị viên</span>
                                        <span th:case="ROLE_USER">Nhân viên</span>
                                    </td>
                                    <td th:text="${#temporals.format(staff.getCreateDate(), 'dd/MM/yyyy HH:mm:ss')}">Ngày bắt đầu</td>
                                    <td th:switch="${staff.getStatus()}">
                                        <span th:case="1">Đang hoạt động</span>
                                        <span th:case="0">Ngừng hoạt động</span>
                                    </td>
                                </tr>
                            </tbody>
                        </table>

                        <!-- Modal Edit Staff -->
                        <div class="modal fade modal-edit-staff" tabindex="-1" style="display: none;" aria-hidden="true">
                            <div class="modal-dialog modal-xl">
                                <div class="modal-content">
                                    <div class="modal-header">
                                        <h5 class="modal-title mt-0">Cập nhật người dùng</h5>
                                        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                    </div>
                                    <form id="formEdit">
                                        <div class="modal-body">
                                            <div class="row">
                                                <div class="col-6 px-4">
                                                    <table class="table-borderless w-100">
                                                        <tr>
                                                            <th><label class="form-label" for="fullName-edit">Họ và tên</label><span class="required"> *</span></th>
                                                            <td><input class="form-control" type="text" name="fullName" id="fullName-edit" onblur="onType(this)"></td>
                                                        </tr>
                                                        <tr>
                                                            <th><label class="form-label" for="staffCode-edit">Mã nhân viên</label><span class="required"> *</span></th>
                                                            <td><input type="text" name="staffCode" id="staffCode-edit" class="form-control" onblur="onType(this)"></td>
                                                        </tr>
                                                        <tr>
                                                            <th><label for="email-edit" class="form-label">Email</label><span class="required"> *</span></th>
                                                            <td><input type="email" name="email" id="email-edit" class="form-control" title="Không thể sửa email" disabled></td>
                                                        </tr>
                                                        <tr>
                                                            <th><label for="role-edit" class="form-label">Chức vụ</label><span class="required"> *</span></th>
                                                            <td>
                                                                <select class="form-select" name="role" id="role-edit">
                                                                    <option value="" disabled selected>-- Chọn Chức vụ --</option>
                                                                    <option value="ROLE_ADMIN">Quản trị viên</option>
                                                                    <option value="ROLE_USER">Nhân viên</option>
                                                                </select>
                                                            </td>
                                                        </tr>
                                                    </table>
                                                </div>
                                                <div class="col-6 px-4">
                                                    <table class="table-borderless w-100">
                                                        <tr>
                                                            <th><label for="phoneNumber-edit" class="form-label">Điện thoại</label><span class="required"> *</span></th>
                                                            <td><input type="number" name="phoneNumber" id="phoneNumber-edit" class="form-control" onblur="onType(this)" placeholder="0323456789"></td>
                                                        </tr>
                                                        <tr>
                                                            <th><label for="address-edit" class="form-label">Địa chỉ</label><span class="required"> *</span></th>
                                                            <td><input type="text" name="address" id="address-edit" class="form-control" onblur="onType(this)"></td>
                                                        </tr>
                                                        <tr>
                                                            <th><label for="birthdate-edit" class="form-label">Ngày sinh</label><span class="required"> *</span></th>
                                                            <td><input type="text" name="dateOfBirth"  id="birthdate-edit" class="form-control" onblur="onType(this)" placeholder="dd/MM/yyyy"></td>
                                                        </tr>
                                                        <tr>
                                                            <th style="vertical-align: top; padding-top: 7px;"><label for="note-edit" class="form-label">Ghi chú</label></th>
                                                            <td><textarea name="note" id="note-edit" cols="30" rows="3"></textarea></td>
                                                        </tr>
                                                    </table>
                                                </div>
                                            </div>
                                        </div>
                                        <input type="hidden" name="id" id="id">
                                    </form>
                                    <div class="modal-footer">
                                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" onclick="resetForm()">
                                            <i class="fas fa-ban me-2"></i>
                                            Đóng
                                        </button>
                                        <button type="button" class="btn btn-success" onclick="resetForm()">
                                            <i class="fa fa-trash me-2"></i>
                                            Làm mới
                                        </button>
                                        <button type="button" id="btnEdit" class="btn btn-primary waves-effect waves-light">
                                            <i class="fas fa-save pe-2"></i>
                                            Lưu
                                        </button>
                                    </div>
                                </div>
                                <!-- /.modal-content -->
                            </div>
                            <!-- /.modal-dialog -->
                        </div>
                        <!-- End Modal Edit Staff -->
                    </section>
                </section>
            </div>
        </div>
    </div>
    <!-- End Page-content -->

    <footer class="footer text-center">
        <script>
            document.write(new Date().getFullYear())
        </script>
        © FShop <span class="d-none d-sm-inline-block"> - Work by <i class="mdi mdi-heart text-danger"></i></span>
    </footer>
</div>
<!-- end main content-->

</div>
<!-- END layout-wrapper -->

<!-- Right Sidebar -->
<div class="right-bar">
    <div data-simplebar class="h-100">
        <div class="rightbar-title px-3 py-4">
            <a href="javascript:void(0);" class="right-bar-toggle float-end">
                <i class="mdi mdi-close noti-icon"></i>
            </a>
            <h5 class="m-0">Settings</h5>
        </div>

        <!-- Settings -->
        <hr class="mt-0">
        <h6 class="text-center mb-0">Choose Layouts</h6>

        <div class="p-4">
            <div class="mb-2">
                <img src="assets/img/layout-1.jpg" class="img-fluid img-thumbnail" alt="">
            </div>
            <div class="form-check form-switch mb-3">
                <input class="form-check-input theme-choice" type="checkbox" id="light-mode-switch">
                <label class="form-check-label" for="light-mode-switch">Light Mode</label>
            </div>

            <div class="mb-2">
                <img src="assets/img/layout-2.jpg" class="img-fluid img-thumbnail" alt="">
            </div>

            <div class="form-check form-switch mb-3">
                <input class="form-check-input theme-choice" type="checkbox" id="dark-mode-switch"
                       data-bsStyle="assets/css/bootstrap-dark.min.css" data-appStyle="assets/css/app-dark.min.css">
                <label class="form-check-label" for="dark-mode-switch">Dark Mode</label>
            </div>

        </div>

    </div>
    <!-- end slimscroll-menu-->
</div>
<!-- end Right Sidebar -->

<!-- JAVASCRIPT -->
<script th:src="@{/assets/js/moment.min.js}"></script>
<script th:src="@{/assets/js/jquery.min.js}"></script>
<script th:src="@{/assets/js/bootstrap.bundle.min.js}"></script>
<script th:src="@{/assets/js/metisMenu.min.js}"></script>
<script th:src="@{/assets/js/simplebar.min.js}"></script>
<script th:src="@{/assets/js/waves.min.js}"></script>

<script th:src="@{/assets/js/morris.min.js}"></script>

<script th:src="@{/assets/js/raphael.min.js}"></script>

<script th:src="@{/assets/js/jquery.peity.min.js}"></script>

<script th:src="@{/assets/js/dashboard.init.js}"></script>

<script th:src="@{/assets/js/fontawesome.init.js}"></script>

<script th:src="@{/assets/js/app.js}"></script>

<script th:src="@{/assets/js/chosen.jquery.js}"></script>
<script th:src="@{/assets/js/chosen.proto.min.js}"></script>
<script th:src="@{/assets/js/chosen.init.js}"></script>

<!-- Required datatable js -->
<script th:src="@{/assets/js/jquery.dataTables.min.js}"></script>
<script th:src="@{/assets/js/dataTables.bootstrap4.min.js}"></script>
<!-- Buttons examples -->
<script th:src="@{/assets/js/vfs_fonts.js}"></script>
<script th:src="@{/assets/js/dataTables.buttons.min.js}"></script>
<script src="https://cdn.datatables.net/select/1.3.3/js/dataTables.select.min.js"></script>
<script th:src="@{/assets/js/buttons.bootstrap4.min.js}"></script>
<script th:src="@{/assets/js/buttons.html5.min.js}"></script>
<script th:src="@{/assets/js/buttons.print.min.js}"></script>
<script th:src="@{/assets/js/buttons.colVis.min.js}"></script>
<script th:src="@{/assets/js/jszip.min.js}"></script>
<script th:src="@{/assets/js/pdfmake.min.js}"></script>
<!-- Responsive examples -->
<script th:src="@{/assets/js/dataTables.responsive.min.js}"></script>
<script th:src="@{/assets/js/responsive.bootstrap4.min.js}"></script>

<!-- Datatable init js -->
<script th:src="@{/assets/js/datatables.init.js}"></script>

<script type="text/javascript">
    $(document).ready(function () {
        $('.roleFilter').chosen();

        hoverIconLock();
    });

    function hoverIconLock() {
        $('.fa-lock-open').hover(function () {
            $(this).removeClass('fa-lock-open').addClass('fa-lock').css('color', 'red');
        }, function () {
            $(this).removeClass('fa-lock').addClass('fa-lock-open').css('color', 'green');
        })

        $('.fa-lock').hover(function () {
            $(this).removeClass('fa-lock').addClass('fa-lock-open').css('color', 'green');
        }, function () {
            $(this).removeClass('fa-lock-open').addClass('fa-lock').css('color', 'red');
        })
    }

    function checkAllJquery(baseId, itemClass) {
        let baseCheck = $('#' + baseId).is(":checked");
        $('.' + itemClass).each(function () {
            if (!$(this).is(':disabled')) {
                $(this).prop('checked', baseCheck);
            }
        });
    }

    $('.arrow').click(function (e) {
        $(this).toggleClass('down');
        $(this).siblings('.expand').toggle();
    })

    $('.check-item').change(function (e) {
        const flag = checkSiblings();

        if (flag) {
            $('#checkAll').prop('checked', true);
        } else {
            $('#checkAll').prop('checked', false);
        }

        function checkSiblings() {
            const checkboxes = $('.check-item').parent().find('input[type="checkbox"]');
            let checkFlag = true;

            checkboxes.each(function () {
                if ($(this).prop("checked") === false) {
                    checkFlag = false;
                }
            });
            return checkFlag;
        }
    });

    // disable mousewheel on a input number field when in focus
    // (to prevent Chromium browsers change the value when scrolling)
    $('form').on('focus', 'input[type=number]', function (e) {
        $(this).on('wheel.disableScroll', function (e) {
            e.preventDefault()
        })
    })
    $('form').on('blur', 'input[type=number]', function (e) {
        $(this).off('wheel.disableScroll')
    })
</script>

<script>
    // event filter table by status
    function onStatusChange(element) {
        const value = $(element).val();
        console.log(value);
        const tagAll = $('#datatable tbody tr');
        const tag = $('tr td').filter(function() {
            return $(this).text()===value;
        });
        console.log(tag);

        if(value==='Tất cả') {
            tagAll.show();
        } else {
            tagAll.hide();
            tag.parent().show();
        }
    }

    // event reset form
    function resetForm() {
        const formInput = $("form :input");
        formInput.val("");
        $('#role').prop('selectedIndex', 0);
        formInput.removeClass('error');
    }

    // Submit formAdd
    $('#btnAdd').click(function () {
        let data = {};
        let formData = $('#formAdd').serializeArray();
        $.each(formData, function (i, v) {
            data["" + v.name + ""] = v.value;
        });

        if(validateForm('add')) {
            addStaff(data);
        } else {
            console.log("validate fail");
        }
    });

    // Event onKeyPress formAdd
    function onType(element) {
        const tag = $(element);
        if(tag.val() === '') {
            tag.addClass('error');
        } else {
            tag.removeClass('error');
        }
    }

    // Validation formAdd
    function validateForm(type) {
        let errorMessage = '';
        const fullName = (type==='add') ? $('#fullName') : $('#fullName-edit');
        let flag = true;

        if (fullName.val() === '') {
            fullName.addClass('error');
            flag = false;
        }

        const email = (type==='add') ? $('#email') : $('#email-edit');
        const patternEmail = /^\b[A-Z0-9._%-]+@[A-Z0-9.-]+\.[A-Z]{2,4}\b$/i;
        if (email.val() === '') {
            email.addClass('error');
            flag = false;
        } else if (!patternEmail.test(email.val())) {
            email.addClass('error');
            errorMessage += 'Email không hợp lệ!\n';
            flag = false;
        }

        const role = (type==='add') ? $('#role') : $('#role-edit');
        if (role.val() === null) {
            role.addClass('error');
            flag = false;
        }

        const phoneNumber = (type==='add') ? $('#phoneNumber') : $('#phoneNumber-edit');
        const patternPhone = /^(84|0[3|5|7|8|9])+([0-9]{8})\b$/i;
        if (phoneNumber.val() === '') {
            phoneNumber.addClass('error');
            flag = false;
        } else if (!patternPhone.test(phoneNumber.val())) {
            phoneNumber.addClass('error');
            errorMessage += 'Số điện thoại không hợp lệ!\n\n';
            flag = false;
        }

        const address = (type==='add') ? $('#address') : $('#address-edit');
        if (address.val() === '') {
            address.addClass('error');
            flag = false;
        }
        const datepicker = (type==='add') ? $('#datepicker') : $('#birthdate-edit');
        if (datepicker.val() === '') {
            datepicker.addClass('error');
            flag = false;
        }

        if (flag) {
            return true
        }
        errorMessage += 'Mời nhập lại!'
        const Toast = Swal.mixin({
            toast: true,
            position: 'top-end',
            showConfirmButton: false,
            timer: 3000,
            timerProgressBar: true,
            didOpen: (toast) => {
                toast.addEventListener('mouseenter', Swal.stopTimer)
                toast.addEventListener('mouseleave', Swal.resumeTimer)
            }
        })
        Toast.fire({
            icon: 'error',
            title: errorMessage
        })
        return false;
    }

    //API add Staff
    function addStaff(data) {
        $.ajax({
            url: '/api/staff',
            type: 'POST',
            contentType: 'application/json',
            data: JSON.stringify(data),
            dataType: 'json',
            success: function (result) {
                const Toast = Swal.mixin({
                    toast: true,
                    position: 'top-end',
                    showConfirmButton: false,
                    timer: 3000,
                    timerProgressBar: true,
                    didOpen: (toast) => {
                        toast.addEventListener('mouseenter', Swal.stopTimer)
                        toast.addEventListener('mouseleave', Swal.resumeTimer)
                    }
                })
                Toast.fire({
                    icon: 'success',
                    title: 'Thêm thành công'
                }).then(() => window.location.href = "/staff");
            },
            error: function (error) {
                const Toast = Swal.mixin({
                    toast: true,
                    position: 'top-end',
                    showConfirmButton: false,
                    timer: 3000,
                    timerProgressBar: true,
                    didOpen: (toast) => {
                        toast.addEventListener('mouseenter', Swal.stopTimer)
                        toast.addEventListener('mouseleave', Swal.resumeTimer)
                    }
                })
                Toast.fire({
                    icon: 'error',
                    title: "Email đã tồn tại!"
                    // title: 'Lỗi khi thêm mới'
                })
            }
        })
    }

    // Submit formEdit
    $('#btnEdit').click(function () {
        let data = {};
        let formData = $('#formEdit').serializeArray();
        $.each(formData, function (i, v) {
            data["" + v.name + ""] = v.value;
        });
        data["dateOfBirth"] = moment(formData.dateOfBirth).format('YYYY-MM-DD')

        if(validateForm('edit')) {
            editStaff(data);
        } else {
            console.log("validate fail");
        }
    });

    //API edit Staff
    function editStaff(data) {
        $.ajax({
            url: '/api/staff',
            type: 'PUT',
            contentType: 'application/json',
            data: JSON.stringify(data),
            dataType: 'json',
            success: function (result) {
                const Toast = Swal.mixin({
                    toast: true,
                    position: 'top-end',
                    showConfirmButton: false,
                    timer: 3000,
                    timerProgressBar: true,
                    didOpen: (toast) => {
                        toast.addEventListener('mouseenter', Swal.stopTimer)
                        toast.addEventListener('mouseleave', Swal.resumeTimer)
                    }
                })
                Toast.fire({
                    icon: 'success',
                    title: 'Cập nhật thành công'
                }).then(() => window.location.href = "/staff");
            },
            error: function (error) {
                const Toast = Swal.mixin({
                    toast: true,
                    position: 'top-end',
                    showConfirmButton: false,
                    timer: 3000,
                    timerProgressBar: true,
                    didOpen: (toast) => {
                        toast.addEventListener('mouseenter', Swal.stopTimer)
                        toast.addEventListener('mouseleave', Swal.resumeTimer)
                    }
                })
                Toast.fire({
                    icon: 'error',
                    title: "Lỗi hệ thống!\nVui lòng thử lại sau"
                })
            }
        })
    }

    function onBtnEdit (element) {
        const tag = $(element).parent().parent().find('.check-item');
        $.ajax({
            url: `/api/staff/${tag.val()}`,
            type: 'GET',
            contentType: 'application/json',
            success: function (result) {
                $('#id').val(result.id);
                $('#fullName-edit').val(result.fullName);
                $('#staffCode-edit').val(result.staffCode);
                $('#email-edit').val(result.email);
                $('#role-edit').val(result.role);
                $('#phoneNumber-edit').val(result.phoneNumber);
                $('#address-edit').val(result.address);
                $('#birthdate-edit').val(moment(result.dateOfBirth).format('DD/MM/YYYY'));
                $('#note-edit').val(result.note);

                $('.modal-edit-staff').modal('show');
            },
            error: function (error) {
                console.log(error);
            }
        })
    }

    function onBtnStatus (element) {
        const tag = $(element).parent().parent();
        const lock = $(element).hasClass('fa-lock');
        const status = lock ? "0" : "1";
        $.ajax({
            url: `/api/staff/status/${tag.find('.check-item').val()}/${status}`,
            type: 'PUT',
            contentType: 'application/json',
            success: function (result) {
                Swal.fire(
                    lock ? 'Đã khoá tài khoản!' : 'Đã mở khoá tài khoản',
                    `Mã nhân viên ${tag.children().eq(3).text()}`,
                    'success'
                ).then(() => {
                    if (lock) {
                        $(element).removeClass('fa-lock-open').addClass('fa-lock').css('color', 'red');
                        tag.children().eq(12).text("Ngừng hoạt động");
                    } else {
                        $(element).removeClass('fa-lock').addClass('fa-lock-open').css('color', 'green');
                        tag.children().eq(12).text("Đang hoạt động");
                    }

                    hoverIconLock();
                })
            },
            error: function (error) {
                console.log(error);
                Swal.fire(
                    'Lỗi hệ thống!\nVui lòng thử lại sau!',
                    'error'
                )
            }
        })
    }

    function onBtnDelete (element) {
        const tag = $(element).parent().parent();
        $.ajax({
            url: `/api/staff/delete/${tag.find('.check-item').val()}`,
            type: 'PUT',
            contentType: 'application/json',
            success: function (result) {
                const swalWithBootstrapButtons = Swal.mixin({
                    customClass: {
                        confirmButton: 'btn btn-success',
                        cancelButton: 'btn btn-danger'
                    },
                    buttonsStyling: false
                })

                swalWithBootstrapButtons.fire({
                    title: `Bạn chắc chắn muốn xoá nhân viên có mã ${tag.children().eq(3).text()} chứ?`,
                    text: "Chú ý không thể hoàn tác sau khi thực hiện tác vụ này!",
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonText: 'Vâng, tôi chắc chắn!',
                    cancelButtonText: 'Không, huỷ bỏ tác vụ!',
                    reverseButtons: true
                }).then((result) => {
                    if (result.isConfirmed) {
                        swalWithBootstrapButtons.fire(
                            'Đã xoá thành công!',
                            'Dữ liệu đã bị xoá.',
                            'success'
                        ).then(() => window.location.href = "/staff");
                    } else if (
                        result.dismiss === Swal.DismissReason.cancel
                    ) {
                        swalWithBootstrapButtons.fire(
                            'Đã huỷ tác vụ',
                            'Dữ liệu được bảo toàn :)',
                            'error'
                        )
                    }
                })
            },
            error: function (error) {
                console.log(error);
            }
        })
    }
</script>

</body>
</html>